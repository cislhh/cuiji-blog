---
slug: web-components-modern-frontend-architecture
title: Web Componentsä¸ç°ä»£å‰ç«¯ç»„ä»¶åŒ–æ¶æ„
date: 2025-07-22
authors: [cuiji]
tags: [web-components, shadow-dom, custom-elements, component-architecture]
keywords: [Web Components, Shadow DOM, è‡ªå®šä¹‰å…ƒç´ , ç»„ä»¶åŒ–æ¶æ„, å‰ç«¯å·¥ç¨‹åŒ–]
---

åœ¨å‰ç«¯å¼€å‘ä¸­ï¼Œæˆ‘ä»¬ç»å¸¸ä½¿ç”¨ Reactã€Vueã€Angular ç­‰æ¡†æ¶æ¥æ„å»ºç»„ä»¶åŒ–åº”ç”¨ã€‚ä½†ä½ æ˜¯å¦æƒ³è¿‡ï¼Œæœ‰æ²¡æœ‰ä¸€ç§æ–¹å¼å¯ä»¥ä¸ä¾èµ–ä»»ä½•æ¡†æ¶ï¼Œå°±èƒ½åˆ›å»ºå¯å¤ç”¨çš„ç»„ä»¶ï¼ŸWeb Components å°±æ˜¯ç­”æ¡ˆã€‚

Web Components æ˜¯ä¸€å¥—æµè§ˆå™¨åŸç”Ÿæ”¯æŒçš„ç»„ä»¶åŒ–æ ‡å‡†ï¼Œå®ƒè®©æˆ‘ä»¬å¯ä»¥åˆ›å»ºçœŸæ­£çš„"ä¸€æ¬¡ç¼–å†™ï¼Œåˆ°å¤„è¿è¡Œ"çš„ç»„ä»¶ã€‚æ— è®ºä½ ä½¿ç”¨ä»€ä¹ˆæ¡†æ¶ï¼Œç”šè‡³ä¸ä½¿ç”¨æ¡†æ¶ï¼Œéƒ½å¯ä»¥ä½¿ç”¨è¿™äº›ç»„ä»¶ã€‚


---

## ä¸€ã€Web Components çš„å››å¤§æ ¸å¿ƒæŠ€æœ¯

> ğŸ¯ æ ¸å¿ƒç†å¿µï¼šWeb Components è®©ç»„ä»¶åŒ–å›å½’æµè§ˆå™¨åŸç”Ÿï¼Œä¸ä¾èµ–ä»»ä½•æ¡†æ¶ã€‚

### 1. Custom Elementsï¼ˆè‡ªå®šä¹‰å…ƒç´ ï¼‰

Custom Elements è®©æˆ‘ä»¬å¯ä»¥åˆ›å»ºè‡ªå·±çš„ HTML æ ‡ç­¾ã€‚

```javascript
// åˆ›å»ºä¸€ä¸ªç®€å•çš„è‡ªå®šä¹‰å…ƒç´ 
class MyButton extends HTMLElement {
  constructor() {
    super();
    this.innerHTML = '<button>ç‚¹å‡»æˆ‘</button>';
  }
}

// æ³¨å†Œè‡ªå®šä¹‰å…ƒç´ 
customElements.define('my-button', MyButton);
```

```html
<!-- åœ¨ HTML ä¸­ä½¿ç”¨ -->
<my-button></my-button>
```

**å®é™…æ•ˆæœ**ï¼šé¡µé¢ä¸Šä¼šæ˜¾ç¤ºä¸€ä¸ªæŒ‰é’®ï¼Œå°±åƒä½¿ç”¨æ™®é€šçš„ HTML æ ‡ç­¾ä¸€æ ·ã€‚

### 2. Shadow DOMï¼ˆå½±å­ DOMï¼‰

Shadow DOM æä¾›äº†çœŸæ­£çš„æ ·å¼å’Œç»“æ„å°è£…ã€‚

```javascript
class MyCard extends HTMLElement {
  constructor() {
    super();
    
    // åˆ›å»º Shadow DOM
    const shadow = this.attachShadow({ mode: 'open' });
    
    // åˆ›å»ºç»„ä»¶å†…å®¹
    shadow.innerHTML = `
      <style>
        .card {
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 16px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .title {
          font-size: 18px;
          font-weight: bold;
          margin-bottom: 8px;
        }
      </style>
      <div class="card">
        <div class="title">å¡ç‰‡æ ‡é¢˜</div>
        <div class="content">å¡ç‰‡å†…å®¹</div>
      </div>
    `;
  }
}

customElements.define('my-card', MyCard);
```

**å…³é”®ä¼˜åŠ¿**ï¼šæ ·å¼å®Œå…¨éš”ç¦»ï¼Œä¸ä¼šå½±å“é¡µé¢å…¶ä»–å…ƒç´ ï¼Œä¹Ÿä¸ä¼šè¢«å¤–éƒ¨æ ·å¼å½±å“ã€‚

### 3. HTML Templatesï¼ˆHTML æ¨¡æ¿ï¼‰

HTML Templates è®©æˆ‘ä»¬å¯ä»¥å®šä¹‰å¯å¤ç”¨çš„ HTML ç»“æ„ã€‚

```html
<!-- å®šä¹‰æ¨¡æ¿ -->
<template id="user-card-template">
  <style>
    .user-card {
      display: flex;
      align-items: center;
      padding: 12px;
      border: 1px solid #eee;
      border-radius: 6px;
      margin: 8px 0;
    }
    .avatar {
      width: 40px;
      height: 40px;
      border-radius: 50%;
      margin-right: 12px;
    }
    .info {
      flex: 1;
    }
    .name {
      font-weight: bold;
      margin-bottom: 4px;
    }
    .email {
      color: #666;
      font-size: 14px;
    }
  </style>
  <div class="user-card">
    <img class="avatar" src="" alt="å¤´åƒ">
    <div class="info">
      <div class="name"></div>
      <div class="email"></div>
    </div>
  </div>
</template>
```

```javascript
// ä½¿ç”¨æ¨¡æ¿åˆ›å»ºç»„ä»¶
class UserCard extends HTMLElement {
  constructor() {
    super();
    
    const template = document.getElementById('user-card-template');
    const templateContent = template.content.cloneNode(true);
    
    this.attachShadow({ mode: 'open' }).appendChild(templateContent);
  }
  
  // è®¾ç½®ç”¨æˆ·æ•°æ®
  setUser(user) {
    const shadow = this.shadowRoot;
    shadow.querySelector('.avatar').src = user.avatar;
    shadow.querySelector('.avatar').alt = user.name;
    shadow.querySelector('.name').textContent = user.name;
    shadow.querySelector('.email').textContent = user.email;
  }
}

customElements.define('user-card', UserCard);
```

### 4. ES Modulesï¼ˆES æ¨¡å—ï¼‰

ES Modules è®©æˆ‘ä»¬å¯ä»¥æ¨¡å—åŒ–åœ°ç»„ç»‡ Web Componentsã€‚

```javascript
// components/Button.js
export class MyButton extends HTMLElement {
  constructor() {
    super();
    this.render();
  }
  
  render() {
    this.innerHTML = `
      <button class="my-button">
        <slot></slot>
      </button>
    `;
  }
}

customElements.define('my-button', MyButton);
```

```javascript
// components/Card.js
export class MyCard extends HTMLElement {
  constructor() {
    super();
    this.render();
  }
  
  render() {
    this.innerHTML = `
      <div class="card">
        <div class="card-header">
          <slot name="header"></slot>
        </div>
        <div class="card-body">
          <slot name="body"></slot>
        </div>
      </div>
    `;
  }
}

customElements.define('my-card', MyCard);
```

```html
<!-- åœ¨ HTML ä¸­å¼•å…¥ -->
<script type="module" src="./components/Button.js"></script>
<script type="module" src="./components/Card.js"></script>

<!-- ä½¿ç”¨ç»„ä»¶ -->
<my-card>
  <div slot="header">å¡ç‰‡æ ‡é¢˜</div>
  <div slot="body">å¡ç‰‡å†…å®¹</div>
</my-card>
```

---

## äºŒã€ç”Ÿå‘½å‘¨æœŸï¼šç»„ä»¶çš„ç”Ÿè€ç—…æ­»

Web Components æä¾›äº†å®Œæ•´çš„ç”Ÿå‘½å‘¨æœŸé’©å­ï¼Œè®©æˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶çš„ä¸åŒé˜¶æ®µæ‰§è¡Œç›¸åº”çš„é€»è¾‘ã€‚

```javascript
class LifecycleDemo extends HTMLElement {
  constructor() {
    super();
    console.log('1. æ„é€ å‡½æ•°æ‰§è¡Œ');
  }
  
  // ç»„ä»¶è¢«æ·»åŠ åˆ° DOM æ—¶è°ƒç”¨
  connectedCallback() {
    console.log('2. ç»„ä»¶å·²è¿æ¥åˆ° DOM');
    this.render();
  }
  
  // ç»„ä»¶ä» DOM ä¸­ç§»é™¤æ—¶è°ƒç”¨
  disconnectedCallback() {
    console.log('3. ç»„ä»¶å·²ä» DOM ä¸­ç§»é™¤');
    this.cleanup();
  }
  
  // ç»„ä»¶å±æ€§å˜åŒ–æ—¶è°ƒç”¨
  attributeChangedCallback(name, oldValue, newValue) {
    console.log(`4. å±æ€§ ${name} ä» ${oldValue} å˜ä¸º ${newValue}`);
    this.updateContent();
  }
  
  // å®šä¹‰éœ€è¦ç›‘å¬çš„å±æ€§
  static get observedAttributes() {
    return ['title', 'count'];
  }
  
  render() {
    this.innerHTML = `
      <div class="lifecycle-demo">
        <h3>${this.getAttribute('title') || 'é»˜è®¤æ ‡é¢˜'}</h3>
        <p>è®¡æ•°: ${this.getAttribute('count') || '0'}</p>
      </div>
    `;
  }
  
  updateContent() {
    // æ ¹æ®å±æ€§å˜åŒ–æ›´æ–°å†…å®¹
    const title = this.getAttribute('title') || 'é»˜è®¤æ ‡é¢˜';
    const count = this.getAttribute('count') || '0';
    
    this.querySelector('h3').textContent = title;
    this.querySelector('p').textContent = `è®¡æ•°: ${count}`;
  }
  
  cleanup() {
    // æ¸…ç†å·¥ä½œï¼Œå¦‚ç§»é™¤äº‹ä»¶ç›‘å¬å™¨
    console.log('æ‰§è¡Œæ¸…ç†å·¥ä½œ');
  }
}

customElements.define('lifecycle-demo', LifecycleDemo);
```

```html
<!-- ä½¿ç”¨ç¤ºä¾‹ -->
<lifecycle-demo title="æˆ‘çš„ç»„ä»¶" count="5"></lifecycle-demo>

<script>
// åŠ¨æ€ä¿®æ”¹å±æ€§
setTimeout(() => {
  const demo = document.querySelector('lifecycle-demo');
  demo.setAttribute('count', '10');
}, 2000);
</script>
```

---

## ä¸‰ã€å±æ€§ä¸äº‹ä»¶ï¼šç»„ä»¶çš„å¯¹å¤–æ¥å£

### å±æ€§ç³»ç»Ÿ

```javascript
class ProductCard extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
  }
  
  // å®šä¹‰å¯è§‚å¯Ÿçš„å±æ€§
  static get observedAttributes() {
    return ['name', 'price', 'image', 'description'];
  }
  
  // å±æ€§å˜åŒ–æ—¶çš„å¤„ç†
  attributeChangedCallback(name, oldValue, newValue) {
    if (oldValue !== newValue) {
      this.render();
    }
  }
  
  // è·å–å±æ€§å€¼
  get name() {
    return this.getAttribute('name') || '';
  }
  
  set name(value) {
    this.setAttribute('name', value);
  }
  
  get price() {
    return this.getAttribute('price') || '0';
  }
  
  set price(value) {
    this.setAttribute('price', value);
  }
  
  render() {
    this.shadowRoot.innerHTML = `
      <style>
        .product-card {
          border: 1px solid #ddd;
          border-radius: 8px;
          padding: 16px;
          max-width: 300px;
          box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }
        .product-image {
          width: 100%;
          height: 200px;
          object-fit: cover;
          border-radius: 4px;
        }
        .product-name {
          font-size: 18px;
          font-weight: bold;
          margin: 12px 0 8px 0;
        }
        .product-price {
          color: #e74c3c;
          font-size: 20px;
          font-weight: bold;
        }
        .product-description {
          color: #666;
          margin-top: 8px;
          line-height: 1.4;
        }
        .add-to-cart {
          background: #3498db;
          color: white;
          border: none;
          padding: 10px 20px;
          border-radius: 4px;
          cursor: pointer;
          margin-top: 12px;
          width: 100%;
        }
        .add-to-cart:hover {
          background: #2980b9;
        }
      </style>
      <div class="product-card">
        <img class="product-image" src="${this.getAttribute('image') || ''}" alt="${this.name}">
        <div class="product-name">${this.name}</div>
        <div class="product-price">Â¥${this.price}</div>
        <div class="product-description">${this.getAttribute('description') || ''}</div>
        <button class="add-to-cart">åŠ å…¥è´­ç‰©è½¦</button>
      </div>
    `;
    
    // æ·»åŠ äº‹ä»¶ç›‘å¬
    this.addEventListeners();
  }
  
  addEventListeners() {
    const button = this.shadowRoot.querySelector('.add-to-cart');
    button.addEventListener('click', () => {
      this.dispatchEvent(new CustomEvent('add-to-cart', {
        detail: {
          name: this.name,
          price: this.price
        },
        bubbles: true
      }));
    });
  }
}

customElements.define('product-card', ProductCard);
```

```html
<!-- ä½¿ç”¨ç»„ä»¶ -->
<product-card 
  name="iPhone 15" 
  price="5999" 
  image="https://example.com/iphone15.jpg"
  description="æœ€æ–°æ¬¾ iPhoneï¼Œæ€§èƒ½å¼ºåŠ²">
</product-card>

<script>
// ç›‘å¬ç»„ä»¶äº‹ä»¶
document.addEventListener('add-to-cart', (event) => {
  console.log('æ·»åŠ åˆ°è´­ç‰©è½¦:', event.detail);
  // å¤„ç†æ·»åŠ åˆ°è´­ç‰©è½¦çš„é€»è¾‘
});
</script>
```

---

## å››ã€æ’æ§½ç³»ç»Ÿï¼šçµæ´»çš„å†…å®¹åˆ†å‘

æ’æ§½ï¼ˆSlotsï¼‰è®©æˆ‘ä»¬å¯ä»¥åœ¨ç»„ä»¶ä¸­æ’å…¥è‡ªå®šä¹‰å†…å®¹ã€‚

```javascript
class MyModal extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
  }
  
  connectedCallback() {
    this.render();
  }
  
  render() {
    this.shadowRoot.innerHTML = `
      <style>
        .modal-overlay {
          position: fixed;
          top: 0;
          left: 0;
          width: 100%;
          height: 100%;
          background: rgba(0, 0, 0, 0.5);
          display: flex;
          justify-content: center;
          align-items: center;
          z-index: 1000;
        }
        .modal-content {
          background: white;
          border-radius: 8px;
          padding: 24px;
          max-width: 500px;
          width: 90%;
          box-shadow: 0 4px 20px rgba(0, 0, 0, 0.3);
        }
        .modal-header {
          display: flex;
          justify-content: space-between;
          align-items: center;
          margin-bottom: 16px;
          padding-bottom: 16px;
          border-bottom: 1px solid #eee;
        }
        .modal-title {
          font-size: 20px;
          font-weight: bold;
          margin: 0;
        }
        .close-button {
          background: none;
          border: none;
          font-size: 24px;
          cursor: pointer;
          color: #999;
        }
        .close-button:hover {
          color: #333;
        }
        .modal-body {
          margin-bottom: 16px;
        }
        .modal-footer {
          display: flex;
          justify-content: flex-end;
          gap: 12px;
        }
        .btn {
          padding: 8px 16px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
        }
        .btn-primary {
          background: #3498db;
          color: white;
        }
        .btn-secondary {
          background: #95a5a6;
          color: white;
        }
      </style>
      <div class="modal-overlay">
        <div class="modal-content">
          <div class="modal-header">
            <h3 class="modal-title">
              <slot name="title">é»˜è®¤æ ‡é¢˜</slot>
            </h3>
            <button class="close-button">&times;</button>
          </div>
          <div class="modal-body">
            <slot name="body">é»˜è®¤å†…å®¹</slot>
          </div>
          <div class="modal-footer">
            <slot name="footer">
              <button class="btn btn-secondary">å–æ¶ˆ</button>
              <button class="btn btn-primary">ç¡®å®š</button>
            </slot>
          </div>
        </div>
      </div>
    `;
    
    this.addEventListeners();
  }
  
  addEventListeners() {
    const closeButton = this.shadowRoot.querySelector('.close-button');
    const overlay = this.shadowRoot.querySelector('.modal-overlay');
    
    closeButton.addEventListener('click', () => this.close());
    overlay.addEventListener('click', (e) => {
      if (e.target === overlay) this.close();
    });
  }
  
  close() {
    this.dispatchEvent(new CustomEvent('modal-close', { bubbles: true }));
    this.remove();
  }
}

customElements.define('my-modal', MyModal);
```

```html
<!-- ä½¿ç”¨æ’æ§½ -->
<my-modal>
  <span slot="title">ç¡®è®¤åˆ é™¤</span>
  <div slot="body">
    <p>æ‚¨ç¡®å®šè¦åˆ é™¤è¿™ä¸ªé¡¹ç›®å—ï¼Ÿæ­¤æ“ä½œä¸å¯æ’¤é”€ã€‚</p>
  </div>
  <div slot="footer">
    <button class="btn btn-secondary">å–æ¶ˆ</button>
    <button class="btn btn-primary" style="background: #e74c3c;">åˆ é™¤</button>
  </div>
</my-modal>
```

---

## äº”ã€ä¸æ¡†æ¶é›†æˆï¼šæœ€ä½³å®è·µ

### åœ¨ React ä¸­ä½¿ç”¨ Web Components

```javascript
// Web Component
class MyCounter extends HTMLElement {
  constructor() {
    super();
    this.count = 0;
    this.attachShadow({ mode: 'open' });
    this.render();
  }
  
  render() {
    this.shadowRoot.innerHTML = `
      <style>
        .counter {
          display: flex;
          align-items: center;
          gap: 12px;
          padding: 16px;
          border: 1px solid #ddd;
          border-radius: 8px;
        }
        .count {
          font-size: 24px;
          font-weight: bold;
        }
        .btn {
          padding: 8px 16px;
          border: none;
          border-radius: 4px;
          cursor: pointer;
          background: #3498db;
          color: white;
        }
        .btn:hover {
          background: #2980b9;
        }
      </style>
      <div class="counter">
        <button class="btn" id="decrement">-</button>
        <span class="count">${this.count}</span>
        <button class="btn" id="increment">+</button>
      </div>
    `;
    
    this.addEventListeners();
  }
  
  addEventListeners() {
    this.shadowRoot.getElementById('increment').addEventListener('click', () => {
      this.count++;
      this.render();
      this.dispatchEvent(new CustomEvent('count-change', {
        detail: { count: this.count }
      }));
    });
    
    this.shadowRoot.getElementById('decrement').addEventListener('click', () => {
      this.count--;
      this.render();
      this.dispatchEvent(new CustomEvent('count-change', {
        detail: { count: this.count }
      }));
    });
  }
}

customElements.define('my-counter', MyCounter);
```

```jsx
// React ç»„ä»¶ä¸­ä½¿ç”¨
import React, { useRef, useEffect } from 'react';

function App() {
  const counterRef = useRef(null);
  
  useEffect(() => {
    const counter = counterRef.current;
    
    const handleCountChange = (event) => {
      console.log('è®¡æ•°å˜åŒ–:', event.detail.count);
    };
    
    counter.addEventListener('count-change', handleCountChange);
    
    return () => {
      counter.removeEventListener('count-change', handleCountChange);
    };
  }, []);
  
  return (
    <div>
      <h1>React + Web Components ç¤ºä¾‹</h1>
      <my-counter ref={counterRef}></my-counter>
    </div>
  );
}
```

### åœ¨ Vue ä¸­ä½¿ç”¨ Web Components

```vue
<template>
  <div>
    <h1>Vue + Web Components ç¤ºä¾‹</h1>
    <my-counter @count-change="handleCountChange"></my-counter>
    <p>å½“å‰è®¡æ•°: {{ currentCount }}</p>
  </div>
</template>

<script>
export default {
  data() {
    return {
      currentCount: 0
    };
  },
  methods: {
    handleCountChange(event) {
      this.currentCount = event.detail.count;
    }
  }
};
</script>
```

---

## å…­ã€æ€§èƒ½ä¼˜åŒ–ï¼šè®©ç»„ä»¶è·‘å¾—æ›´å¿«

### æ‡’åŠ è½½ç»„ä»¶

```javascript
// æ‡’åŠ è½½ Web Component
class LazyComponent extends HTMLElement {
  constructor() {
    super();
    this.loaded = false;
  }
  
  connectedCallback() {
    if (!this.loaded) {
      this.loadComponent();
    }
  }
  
  async loadComponent() {
    // æ˜¾ç¤ºåŠ è½½çŠ¶æ€
    this.innerHTML = '<div>åŠ è½½ä¸­...</div>';
    
    try {
      // åŠ¨æ€å¯¼å…¥ç»„ä»¶
      const { MyHeavyComponent } = await import('./HeavyComponent.js');
      
      // åˆ›å»ºç»„ä»¶å®ä¾‹
      const component = new MyHeavyComponent();
      this.appendChild(component);
      
      this.loaded = true;
    } catch (error) {
      this.innerHTML = '<div>åŠ è½½å¤±è´¥</div>';
      console.error('ç»„ä»¶åŠ è½½å¤±è´¥:', error);
    }
  }
}

customElements.define('lazy-component', LazyComponent);
```

### ç»„ä»¶ç¼“å­˜

```javascript
// ç»„ä»¶ç¼“å­˜ç®¡ç†å™¨
class ComponentCache {
  constructor() {
    this.cache = new Map();
  }
  
  get(key) {
    return this.cache.get(key);
  }
  
  set(key, component) {
    this.cache.set(key, component);
  }
  
  has(key) {
    return this.cache.has(key);
  }
}

const componentCache = new ComponentCache();

// ä½¿ç”¨ç¼“å­˜çš„ç»„ä»¶
class CachedComponent extends HTMLElement {
  constructor() {
    super();
    this.componentKey = this.getAttribute('component-key');
  }
  
  connectedCallback() {
    if (componentCache.has(this.componentKey)) {
      // ä½¿ç”¨ç¼“å­˜çš„ç»„ä»¶
      const cachedComponent = componentCache.get(this.componentKey);
      this.appendChild(cachedComponent.cloneNode(true));
    } else {
      // åˆ›å»ºæ–°ç»„ä»¶å¹¶ç¼“å­˜
      this.createComponent();
    }
  }
  
  createComponent() {
    // åˆ›å»ºç»„ä»¶çš„é€»è¾‘
    const component = document.createElement('div');
    component.textContent = 'æ–°ç»„ä»¶';
    componentCache.set(this.componentKey, component);
    this.appendChild(component);
  }
}

customElements.define('cached-component', CachedComponent);
```

---

## ä¸ƒã€å®é™…é¡¹ç›®ä¸­çš„åº”ç”¨åœºæ™¯

### 1. è®¾è®¡ç³»ç»Ÿç»„ä»¶åº“

```javascript
// æŒ‰é’®ç»„ä»¶
class DesignButton extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
  }
  
  static get observedAttributes() {
    return ['variant', 'size', 'disabled'];
  }
  
  attributeChangedCallback() {
    this.render();
  }
  
  render() {
    const variant = this.getAttribute('variant') || 'primary';
    const size = this.getAttribute('size') || 'medium';
    const disabled = this.hasAttribute('disabled');
    
    this.shadowRoot.innerHTML = `
      <style>
        .btn {
          border: none;
          border-radius: 4px;
          cursor: pointer;
          font-family: inherit;
          font-weight: 500;
          transition: all 0.2s;
        }
        
        .btn:disabled {
          opacity: 0.6;
          cursor: not-allowed;
        }
        
        /* å˜ä½“æ ·å¼ */
        .btn--primary {
          background: #3498db;
          color: white;
        }
        .btn--primary:hover:not(:disabled) {
          background: #2980b9;
        }
        
        .btn--secondary {
          background: #95a5a6;
          color: white;
        }
        .btn--secondary:hover:not(:disabled) {
          background: #7f8c8d;
        }
        
        /* å°ºå¯¸æ ·å¼ */
        .btn--small {
          padding: 6px 12px;
          font-size: 12px;
        }
        .btn--medium {
          padding: 8px 16px;
          font-size: 14px;
        }
        .btn--large {
          padding: 12px 24px;
          font-size: 16px;
        }
      </style>
      <button class="btn btn--${variant} btn--${size}" ${disabled ? 'disabled' : ''}>
        <slot></slot>
      </button>
    `;
  }
}

customElements.define('design-button', DesignButton);
```

### 2. ç¬¬ä¸‰æ–¹é›†æˆç»„ä»¶

```javascript
// åœ°å›¾ç»„ä»¶
class MapComponent extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
    this.map = null;
  }
  
  static get observedAttributes() {
    return ['latitude', 'longitude', 'zoom'];
  }
  
  attributeChangedCallback() {
    if (this.map) {
      this.updateMap();
    }
  }
  
  connectedCallback() {
    this.render();
    this.initMap();
  }
  
  render() {
    this.shadowRoot.innerHTML = `
      <style>
        .map-container {
          width: 100%;
          height: 400px;
          border: 1px solid #ddd;
          border-radius: 8px;
        }
      </style>
      <div class="map-container" id="map"></div>
    `;
  }
  
  async initMap() {
    // åŠ¨æ€åŠ è½½åœ°å›¾ API
    if (!window.google) {
      await this.loadGoogleMapsAPI();
    }
    
    const mapContainer = this.shadowRoot.getElementById('map');
    const lat = parseFloat(this.getAttribute('latitude')) || 39.9042;
    const lng = parseFloat(this.getAttribute('longitude')) || 116.4074;
    const zoom = parseInt(this.getAttribute('zoom')) || 10;
    
    this.map = new google.maps.Map(mapContainer, {
      center: { lat, lng },
      zoom: zoom
    });
  }
  
  loadGoogleMapsAPI() {
    return new Promise((resolve) => {
      const script = document.createElement('script');
      script.src = 'https://maps.googleapis.com/maps/api/js?key=YOUR_API_KEY';
      script.onload = resolve;
      document.head.appendChild(script);
    });
  }
  
  updateMap() {
    if (this.map) {
      const lat = parseFloat(this.getAttribute('latitude'));
      const lng = parseFloat(this.getAttribute('longitude'));
      const zoom = parseInt(this.getAttribute('zoom'));
      
      this.map.setCenter({ lat, lng });
      this.map.setZoom(zoom);
    }
  }
}

customElements.define('map-component', MapComponent);
```

---

## å…«ã€å¸¸è§é—®é¢˜ä¸è§£å†³æ–¹æ¡ˆ

### é—®é¢˜1ï¼šæ ·å¼ä¸ç”Ÿæ•ˆ

```javascript
// é”™è¯¯åšæ³•ï¼šæ ·å¼åœ¨ Shadow DOM å¤–éƒ¨å®šä¹‰
class BadComponent extends HTMLElement {
  constructor() {
    super();
    this.innerHTML = '<div class="my-component">å†…å®¹</div>';
  }
}

// æ­£ç¡®åšæ³•ï¼šæ ·å¼åœ¨ Shadow DOM å†…éƒ¨å®šä¹‰
class GoodComponent extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
    this.shadowRoot.innerHTML = `
      <style>
        .my-component {
          color: red;
        }
      </style>
      <div class="my-component">å†…å®¹</div>
    `;
  }
}
```

### é—®é¢˜2ï¼šäº‹ä»¶ç›‘å¬å™¨å†…å­˜æ³„æ¼

```javascript
class EventComponent extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
    this.boundHandler = this.handleClick.bind(this);
  }
  
  connectedCallback() {
    this.shadowRoot.innerHTML = '<button>ç‚¹å‡»æˆ‘</button>';
    this.shadowRoot.querySelector('button').addEventListener('click', this.boundHandler);
  }
  
  disconnectedCallback() {
    // æ¸…ç†äº‹ä»¶ç›‘å¬å™¨
    this.shadowRoot.querySelector('button').removeEventListener('click', this.boundHandler);
  }
  
  handleClick() {
    console.log('æŒ‰é’®è¢«ç‚¹å‡»');
  }
}
```

### é—®é¢˜3ï¼šå±æ€§å˜åŒ–ä¸å“åº”

```javascript
class ReactiveComponent extends HTMLElement {
  constructor() {
    super();
    this.attachShadow({ mode: 'open' });
  }
  
  // å¿…é¡»å®šä¹‰ observedAttributes
  static get observedAttributes() {
    return ['title', 'count'];
  }
  
  // å±æ€§å˜åŒ–æ—¶ä¼šè¢«è°ƒç”¨
  attributeChangedCallback(name, oldValue, newValue) {
    if (oldValue !== newValue) {
      this.render();
    }
  }
  
  render() {
    this.shadowRoot.innerHTML = `
      <div>
        <h3>${this.getAttribute('title') || 'é»˜è®¤æ ‡é¢˜'}</h3>
        <p>è®¡æ•°: ${this.getAttribute('count') || '0'}</p>
      </div>
    `;
  }
}
```

---

## ç»“è¯­

Web Components ä¸ºæˆ‘ä»¬æä¾›äº†ä¸€ç§ä¸ä¾èµ–æ¡†æ¶çš„ç»„ä»¶åŒ–è§£å†³æ–¹æ¡ˆã€‚å®ƒç‰¹åˆ«é€‚åˆï¼š

1. **è·¨æ¡†æ¶å¤ç”¨**ï¼šä¸€æ¬¡ç¼–å†™ï¼Œåœ¨ Reactã€Vueã€Angular ä¸­éƒ½èƒ½ä½¿ç”¨
2. **æ¸è¿›å¼é‡‡ç”¨**ï¼šå¯ä»¥åœ¨ç°æœ‰é¡¹ç›®ä¸­é€æ­¥å¼•å…¥
3. **æ€§èƒ½ä¼˜åŒ–**ï¼šåŸç”Ÿæµè§ˆå™¨æ”¯æŒï¼Œæ€§èƒ½ä¼˜ç§€
4. **é•¿æœŸç»´æŠ¤**ï¼šä¸ä¾èµ–ç¬¬ä¸‰æ–¹æ¡†æ¶ï¼ŒæŠ€æœ¯æ ˆç¨³å®š

ä½†ä¹Ÿè¦æ³¨æ„ Web Components çš„å±€é™æ€§ï¼š
- æµè§ˆå™¨å…¼å®¹æ€§ï¼ˆéœ€è¦ polyfillï¼‰
- å¼€å‘ä½“éªŒä¸å¦‚æ¡†æ¶å‹å¥½
- ç”Ÿæ€ç³»ç»Ÿç›¸å¯¹è¾ƒå°

é€‰æ‹© Web Components è¿˜æ˜¯æ¡†æ¶ç»„ä»¶ï¼Œè¦æ ¹æ®å…·ä½“é¡¹ç›®éœ€æ±‚æ¥å†³å®šã€‚è®°ä½ï¼š**æŠ€æœ¯æœåŠ¡äºä¸šåŠ¡ï¼Œé€‰æ‹©æœ€é€‚åˆçš„è§£å†³æ–¹æ¡ˆ**ã€‚